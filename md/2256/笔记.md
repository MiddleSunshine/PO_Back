# 函数的基本使用

```c

#include <stdlib.h>

void *malloc(size_t size);

// Returns pointer to allocated memory on success,or NULL on error
```

# malloc() 的实现

> malloc() 的实现很简单。它首先会扫描之前由free()所释放出来的空闲内存块列表，以求找到尺寸大于或等于要求的一块内存。（取决于具体实现，采用的扫描策略会有所不同。例如 first-fit 或 best-fit。）如果这一内存块的尺寸正好与要求相当，就把它直接返回给调用者，如果是一块较大的内存，那么将对其进行分割，在将一块大小相当的内存返回给调用者的同时，把较小的那块空闲内存块保留在空闲列表中。

> 如果在空闲内存列表中根本找不到足够大的空闲内存块，那么 malloc 会调用 sbrk 以分配更多的内存

上面要注意的是：

1. 要么找到一块大于或者等于所要求的，那么直接返回
2. 如果大太多（这个太多的概念暂时不用纠结），就会把这块拆了
3. 如果把所有空闲内存块都遍历了一遍还是没有找到合适的，就会调控 sbrk 来调整 program break，申请更多内存
