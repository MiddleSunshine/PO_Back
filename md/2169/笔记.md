![](http://oss-file-cache.oss-cn-shanghai.aliyuncs.com/1656059244_image.png)

简单点来说其中各个部分的关系就是：

1. 文件描述符是进程级别的，由各个进程自己维护
2. 打开文件表是系统级别的，代表系统中的一个个文件
3. i-node表也是系统级别的，更贴近于存储层面的一个文件

比如一个文件A，由进程A和B打开，那么A和B就个有一份文件描述符。
然后这个文件A有一个软链接文件，那么在文件表中就有两条记录，但是这两条记录都指向一个i-node记录。

同样因为进程本身并不保存文件的偏移量和文件标志，这些信息都是在打开文件表里的，所以进程能共享这些值。

close-on-exec 则是文件描述表保存的，所有各个进程可以自己设置。